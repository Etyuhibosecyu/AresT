# Ares T
<b>Ares T</b> - программа сжатия информации (особенно текстов, но сжимает большинство "реальных" файлов, кроме уже сжатых каким-либо другим алгоритмом), созданная компанией Red-Star-Soft. Программа прошла долгую эволюцию: сначала это был FileCompressor, сжимающий только одной последовательностью: Хаффман - RLE - Лемпель-Зив - и записывающий в файл в "псевдобайтном" формате (изобретение компании Red-Star-Soft, позже оказавшееся хуже существующих подобных решений). Затем добавилось много других алгоритмов, таких как "Хаффман для слов" (также изобретение компании Red-Star-Soft), BWT, PPM и арифметическое кодирование, и программа получила красивое название <b>Ares</b>, что означает одновременно и отсылку к древним религиям, и аналогию с ARJ, ARK и т. д., где буквы "ES" являются сокращением от "Etyuhibosecyu" - коллективного псевдонима компании Red-Star-Soft. Но недостаток Ares был в том, что при попытке распаковать любой алгоритм сложнее Хаффмана для слов он вылетал (в конце вылет сменился на выдачу сообщения об ошибке), а также в том, что он использовал явное прерывание потоков, работающее только на старых версиях .NET, что не позволяло воспользоваться всеми преимуществами .NET 5 и последующих версий. Поэтому в новом приложении пришлось сразу же со старта переписать около половины. Оно получило название "<b>Ares T</b>", где буква T - сокращение от <b>T</b>ext, с заделом на <b>I</b>mages, <b>A</b>udio, <b>V</b>ideo и <b>Z</b>ipping. В конечном итоге от старого Ares не осталось почти ничего неизменённого (а о FileCompressor вообще можно забыть). Ares T "научился" распаковывать арифметическое кодирование и BWT, "отказался" от Хаффмана для слов в пользу двух отдельных алгоритмов - разбиения на слова и арифметического "Хаффмана", которые также теперь свободно распаковываются - и благодаря множеству невероятных улучшений, в основном касающихся Лемпеля-Зива, смог на пике своей мощи сжать Властелина Колец ("эталонный" текст, на котором мы чаще всего проверяем работу своих алгоритмов сжатия) до размера существенно меньше Zip (1.46 МБ против "окна" от 1.65 до 1.73 МБ) менее чем за 5 секунд (3.585), а затем корректно распаковать! Это был <b>ПРОРЫВ!</b> Но Ares T не стоит на месте, а продолжает развиваться: в ближайшем будущем мы планируем заняться оптимизацией PPM для слов (который сжимает Властелина Колец до размера, сравнимого с 7z, но тратит на это почти два часа), а когда-нибудь, возможно, реализуем и великие и ужасные, загадочные FlexRegimes.<br><br>

Словарь местного "новояза":<br>
<b>Адаптивный Хаффман</b> - адаптивное арифметическое кодирование (см. Хаффман).<br>
<b>Архаический Хаффман</b> - см. Хаффман.<br>
<b>Двойной список</b> (также <b>двумерный список</b>) - двумерный список интервалов (см.) - внутреннее представление выходного потока, которое легко модифицировать, но которое занимает достаточно много памяти. Лишь в конце преобразуется в байты. На момент написания этих строк признано в некоторых случаях устаревшим, но замена пока не разработана. Аналогично определяется применяемый в Хаффмане для слов (см.) тройной список.<br>
<b>Интервал</b> - в арифметическом кодировании (см. Хаффман) у нас так называется не сам рабочий или какой-либо другой интервал, а структура из трех чисел типа uint - нижней границы, длины и основания - однозначно задающая итерацию сокращения рабочего интервала. До преобразования в байты выходной поток представлен либо двумерным, либо трехмерным списком таких "интервалов" (см. двойной список).<br>
<b>Лемпель-Зив</b> - алгоритм словарного сжатия, имеющий очень отдаленное сходство с оригинальным LZ77, немного ближе - с LZSS. Основание всех входных интервалов увеличивает на 5%, а повторяющиеся блоки кодирует интервалом, занимающим эти самые последние 5%, после чего следуют длина, расстояние (не наоборот) и спиральная длина (см.).<br>
<b>Ноль, нуль</b> не символ '0', как можно было бы подумать, а байт, значение которого равно 0x00, или в терминологии C# '&#92;0'. Если файл содержит нулей больше, чем 1/20 квадратного корня от всех байт (8 для 28 КБ или 100 для 4 МБ), Хаффман для слов (см.) определяет его как не текст.<br>
<b>Псевдобайт</b> - ячейка памяти не с 256, как у байта, а с абсолютно любым натуральным числом состояний - от 1 (вырожденный случай) до 4294697295 (предел типа uint в C#). По сути - цифра в определенной системе счисления, причем в псевдобайтном коде каждая цифра записывается в своей собственной системе счисления, и все это особым способом упаковывается в одну последовательность бит/байт.<br>
<b>Спиральная длина</b> - в Лемпеле-Зиве (см.) количество "витков" повторения одной и той же строки подряд. При этом "настоящая" длина ограничивается длиной одного повторения. Так как повторы происходят подряд, то поле расстояния становится бессмысленным, и в него записывается особое служебное значение, сигнализирующее о появлении спиральной длины, которая в других случаях просто отсутствует, и вместо нее в выходной поток не записывается ничего. В тексте тоже может встретиться несколько спиральных длин, но особенно полезны они при сжатии изображения.<br>
<b>Хаффман</b> - арифметическое кодирование. "Настоящий" Хаффман у нас называется "архаическим Хаффманом". Исторический фон этого такой: сначала покойный основатель Red-Star-Soft создал в своем FileCompressor псевдобайтное (см. псевдобайт) энтропийное кодирование и назвал это "NewHuffman". Уже на этапе Ares из-за малого опыта в отношении интернет-травли поддался на провокации и решил сделать "чистый код" (хотя для нас он и так был достаточно чистым). В результате этого вместо одной функции получился целый класс, а так как класс в C# конструируется с помощью ключевого слова new, то сами понимаете чистоту конструкции <tt>new NewHuffman(...)</tt>. Поэтому префикс New автоматически отбросился. Потом класс снова "сжался" до одного метода, но префикс уже не вернулся. (К слову, на момент написания этих строк снова имел место класс Huffman.) Потом на смену псевдобайтному пришло арифметическое кодирование, но название Huffman сохранилось для избежания путаницы с ArithmeticEncoder и ArithmeticDecoder. Так с того времени и висит.<br>
<b>Хаффман для слов</b> - историческое название применения к одному входному потоку: 1) Разбиения на слова - процесс разбиения текста на естественном (русском, английском) языке на условные "слова". "Словом" является либо последовательность идущих подряд букв естественного языка, либо перевод строки, состоящий из одного или двух символов, либо один символ другого типа, кроме пробела (например, запятая), либо строка нулевой длины (при множественных пробелах, см. далее в этом пункте). Каждое "слово" однозначно определяется длиной и содержимым и получает номер ссылки, что определяет три двойных списка (см.) - длин, содержимого и ссылок, причем повторяющиеся слова исключаются из списков длин и содержимого. Наличие или отсутствие пробела после слова является отдельным его свойством, которое пишется после ссылки, а в слово пробел не входит. 2) Хаффмана (см.) к каждому из полученных двойных списков. Раньше эти два действия применялись одной функцией, но теперь - абсолютно разными, и между ними можно вставить что-то еще, например, Лемпель-Зив (см.). Следует понимать, что эта конструкция сжимает все, что хоть немного похоже на текст - состоит из "слов" и содержит мало нулей (см.) - но <b>хорошо</b> сжимает только <b>хороший</b> текст. У нас есть даже способы примерно оценить, насколько "хорошим" является тот или другой текст, и речь совсем не о "высокохудожественных" качествах, а об орфографических и пунктуационных особенностях - о наличии смешения алфавитов слишком близко друг к другу, посторонних символов (например, HTML-тегов), множества вариантов написания, по сути, одного и того же слова (опечаток, устаревших, диалектных написаний и т. д., например, "берег" и "брег"), что анализатор определит как разные слова и т. д. В результате этого две версии одного и того же произведения могут быть сжаты совершенно по-разному. Так, например, находящийся у меня экземпляр "Властелина Колец" является по этой шкале почти идеальным текстом (примерно 95%), а "Война и мир" - существенно хуже (около 80%). Если это значение падает ниже 50%, сжимать Хаффманом для слов не имеет смысла.<br><br>

Payeer: P19926501<br>
Monero: 4AHvZX6BHNcZ6T2iCq4Ruu3nGXipEzjdyYPpvLGMqCzXartsMJoFBxRjXEeKRXDu96JCyYvvPunNnSMBeKYTS8iXBw9z6p3<br>
TRC20 (TRX, USDT etc.): TUKh42VHJNTSCmCdu5rnGo8fDotDK8rHA5<br>
Вопросы: adminATred-star-softDOTcom<br>
